{% load bootstrap4 %}
{% load humanize %}
{% load static %}
{% now "Y-m-d" as todays_date %}
{% load mathfilters %}


<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.7 shrink-to-fit=no">
    {% bootstrap_css %}
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Material Design Bootstrap -->
    <link rel="stylesheet" href="{% static 'css/mdb.min.css' %}">
    <!-- Your custom styles (optional) -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <!-- MDBootstrap Datatables  -->
    <link href="{% static 'css/addons/datatables.min.css' %}" rel="stylesheet">
    <style>
        .btn-xs {
            padding: 5px 10px;
            font-size: 10px;
            line-height: 1.0;

        }

        .my-table {
            overflow-x: auto;
            zoom: 80%;
        }

        table.width {
            width: 85%;
            margin: 20px auto;
            table-layout: auto;
            /* Optional */
            border-collapse: collapse;
            white-space: nowrap;

        }


        td {
            border: 1px solid #000;
        }


        .tab {
            position: absolute;
            right: 250px;
            margin-top: 10px;
        }

        td.border_bottom {
            border-bottom: 1pt solid black;
            border-collapse: collapse;
        }

        td {
            border-style: none;
        }

        tfoot {
            font-weight: bold;
        }


        .clicked {
            background-color: #111111 !important;
            color: whitesmoke !important;
            background-color: #a9a9a9 !important;
            color: black !important;
        }

    </style>
    <style>
        .table-hover>tbody>tr:not(.nothover):hover>td,
        .table-hover>tbody>tr:not(.nothover):hover>th {
            background-color: #a9a9a9;
            color: black;
        }

        body {
            background-color: white;
        }

        .placa-format {
            text-align: center;
            
        }

    </style>
    <!--Favicon-->
    <link rel="icon" href="{% static 'images/favicon.png' %}">

    {% for pedido in pedidos %}
    <title>{{ pedido.contrato }} | {{ pedido.fornecedor.nome }} | Carregamento</title>
    {% endfor %}
</head>

{% for pt in pedidos %}
{% if pt.produto == "Arroz em Casca" %}
<!--Tabel do CASCA-->
<div class="table-responsive table-width my-table">

    <body>
        <br><br>
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Contrato </span></h2>
                </div>

            </div>
        </div>

        <!--------------------------PEdidos---------------------------->
        <table class="width table table-sm table-borderless align-text-center " width=100>
            <thead class="thead-dark">
                <tr align="center">

                    <th scope="col"><strong> Contrato</strong></th>
                    <th scope=" col"><strong> Situação</strong></th>
                    <th scope="col"><strong> Data</strong></th>
                    <th scope="col"><strong> Fornecedor</strong></th>
                    <th scope="col"><strong> Origem </strong></th>
                    <th scope="col"><strong> Cliente</strong></th>
                    <th scope="col"><strong> Preço</strong></th>
                    <th scope="col"><strong> Produto</strong></th>
                    <th scope="col"><strong> Tipo</strong></th>
                    <th scope="col"><strong> Frete</strong></th>
                    <th scope="col"><strong> Quantidade</strong></th>
                    <th scope="col"><strong> Quantidade Kg </strong></th>
                    <th scope="col"><strong> Carregado</strong></th>
                    <th scope="col"><strong> Saldo</strong></th>
                </tr>

            </thead>
            <tbody class="">
                {% for pedido in pedidos %}

                <tr align="center">
                    <td class="border_bottom"> <strong>{{ pedido.contrato }}</strong></td>
                    {% if pedido.situacao == 'a' %}
                    <td class="border_bottom text text-primary"><strong>Aberto</strong></td>
                    {% elif pedido.situacao == 'b' %}
                    <td class="border_bottom text text-danger"><strong>Fechado</strong></td>
                    {% elif pedido.situacao == 'c' %}
                    <td class="border_bottom text text-danger"><strong>Cancelado</strong></td>
                    {% else %}
                    {% endif %}
                    <td class="border_bottom"><strong>{{ pedido.data|date:"SHORT_DATE_FORMAT" }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor|title|truncatechars:50 }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor.cidade|truncatechars:25 }}</strong></td>

                    <td class="border_bottom"><strong>{{ pedido.cliente|upper }}</strong></td>


                    <td class="border_bottom"><strong>R$ {{ pedido.preco_produto|intcomma  }}</strong></td>
                    <td class="border_bottom"><strong> {{ pedido.produto  }} </strong></td>
                    {% if pedido.produto == 'Arroz em Casca' %}
                    <td class="border_bottom"><strong> Saco 50Kg </strong></td>
                    {% else %}
                    <td class="border_bottom"><strong> Fardo 30Kg </strong></td>
                    {% endif %}
                    <td class="border_bottom"><strong> R$ {{ pedido.preco_frete  }} </strong></td>
                    {% if pedido.produto == "Arroz em Casca" %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:50|floatformat:"0"}}
                            Scs </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:30|floatformat:"0"}}
                            Fds </strong></td>
                    {% endif %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|intcomma }} Kg </strong>
                    </td>
                    {% if pedido.carregado == 0 %}
                    <td class="border_bottom" align=center><strong> - </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong><strong>{{ pedido.carregado }} Kg</strong></strong>
                    </td>
                    {% endif %}
                    {% if pedido.quantidade_pedido|sub:pedido.carregado < 0 %} {
                    <td class="border_bottom text text-danger" align=center><strong> {{ pedido.quantidade_pedido|sub:pedido.carregado }} Kg </strong></td>
                    {% else %}
                    <td class="border_bottom text text-primary" align=center><strong>{{ pedido.quantidade_pedido|sub:pedido.carregado }} Kg</strong></td>
                    {% endif %}
                </tr>

                {% endfor %}
            </tbody>
        </table>
        <br>


        <!--------------------------Cargas-------------------------------------------------------------->


        {% if cargas %}
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Relatório Carregamento
                        </span></h2>
                    <i type="submit" style="color:green; margin-right: 5px; margin-top: 12px;" class="fas fa-lg fa-file-excel" id="btnExport"></i>
                    <i type="submit" style="color:black; margin-right: 5px; margin-top: 12px;" class="fas fa-lg fa-file-pdf" id="pdf" onclick="createPDF()"
                        target="_blank"></i>
                    {% for carga in cargas|slice:":1" %}
                        {% if user.is_superuser %}
                    <a href="{% url 'detail_cargas_comiss' carga.pedido.pk %}" style="color:green; margin-top: 12px;" class="fas fa-lg fa-usd"></a>                    
                        {% endif %}
                    {% endfor %}

                </div>

            </div>
        </div>
        <!--------------------------------EXCEL---------------------------------->
        <div class="container-fluid" id="cargasrelatorio2" style="display: none">
            <table class=" width table table-sm table-hover cargaspdf" align="center">



                <thead align="center" class="table-bordered thead-dark">

                    <tr>
                        <th scope="col"><a class="text-white fa fa-sort-desc"></a></th>
                        <th scope="col"><strong>Contrato</strong></th>
                        <th scope="col"><strong>Data</strong></th>
                        <th scope="col"><strong>Transportadora</strong></th>
                        <th scope="col"><strong>Fornecedor</strong></th>
                        <th scope="col"><strong>Placa</strong></th>
                        <th scope="col"><strong>Motorista</strong></th>
                        <th scope="col"><strong>Peso</strong></th>
                        <th scope="col"><strong>Valor Produto</strong></th>
                        <th scope="col"><strong>NF</strong></th>
                        {% if notafiscal2 %}
                        <th scope="col"><strong>NF 2</strong></th>
                        {% else %}
                        {% endif %}

                        <th scope="col"><strong>Renda </strong></th>
                        <th scope="col"><strong>Inteiro </strong></th>
                        <th scope="col"><strong>Impureza </strong></th>
                        <th scope="col"><strong>Umidade </strong></th>
                        <th scope="col"><strong>Gessado </strong></th>
                        <th scope="col"><strong>B.Branca </strong></th>
                        <th scope="col"><strong>Amarelo</strong></th>
                        <th scope="col"><strong>Manch/Pic </strong></th>
                        <th scope="col"><strong>Vermelhos </strong></th>
                    </tr>


                </thead>

                <tbody class="align-text-bottom ">
                    {% for pedido in pedidos %}
                    <tr align="center" >
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td align="right" colspan="4" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        {% if pedido.renda == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.renda }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.inteiro == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.inteiro }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.impureza == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.impureza }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.umidade == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.umidade }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.gessado == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.gessado }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.bbranca == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.bbranca }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.amarelo == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.amarelo }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.manchpic == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.manchpic }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.vermelhos == None %}
                        <td class="border_bottom corpo">-</td>
                        {% else %}
                        <td class="border_bottom corpo">
                            <strong><i>{{ pedido.vermelhos }}</i></strong>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    {% for carga in cargas %}
                    {% for pedido in pedidos %}
                    {% if carga.situacao == 'Carregado' %}

                    <tr align="center" class="corpodados simplehighlight">                        
                        <td>{{ forloop.parentloop.counter }}</td>
                        <td>{{ carga.pedido }}</td>
                        <td>{{ carga.data|date:"SHORT_DATE_FORMAT" }}</td>
                        <td>{{ carga.transp|title }}</td>
                        <td>{{ carga.pedido.fornecedor.nome|title }}
                            </td>
                        <td class="placa-format">
                                {{ carga.placa|upper|slice:":3"}} {{ carga.placa|upper|slice:"3:"}}</td>
                        <td>{{ carga.motorista|title }}</td>
                        <td>{{ carga.peso|intcomma }} </td>
                        {% if carga.valornf == None or carga.valornf == 0 %}
                        <td>R$ &nbsp; - </td>
                        {% else %}
                        <td>R$ {{carga.valornf|floatformat:"2"}}</td>
                        {% endif %}
                        {% if carga.notafiscal == None %}
                        <td class="text-danger"><strong>Sem NF</strong></td>
                        {% elif carga.notafiscal|length <= 4 %}
                        <td>
                                {{ carga.notafiscal }}
                            </td>
                        {% elif carga.notafiscal|length <= 6 %}
                        <td>
                                {{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </td>
                        {% elif carga.notafiscal|length > 6 and carga.notafiscal|length < 8 %}
                        <td>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </td>

                        {% elif carga.notafiscal|length == 8 %}
                        <td>
                                0{{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </td>
                        {% elif carga.notafiscal|length > 8 %}
                        <td>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </td>
                        {% else %}
                        <td>{{carga.notasfiscal}}</td>
                        {% endif %}
                        {% if notafiscal2 %}
                        <td>{{carga.notasfiscal2}}</td>
                        {% else %}
                        {% endif %}

                        {% if carga.renda == None %}
                        <td>-</td>
                        {% elif carga.renda < pedido.renda %}
                        <td class="text-danger"> {{carga.renda}}</td>
                        {% else %}
                        <td> {{carga.renda}}</td>
                        {% endif %}

                        {% if carga.inteiro == None %}
                        <td>-</td>
                        {% elif carga.inteiro < pedido.inteiro %}
                        <td class="text-danger"> {{carga.inteiro}}</td>
                        {% else %}
                        <td> {{carga.inteiro}}</td>
                        {% endif %}

                        {% if carga.impureza == None %}
                        <td>-</td>
                        {% elif carga.impureza > pedido.impureza %}
                        <td class="text-danger"> {{carga.impureza}}</td>
                        {% else %}
                        <td> {{carga.impureza}}</td>
                        {% endif %}

                        {% if carga.umidade == None %}
                        <td>-</td>
                        {% elif carga.umidade > pedido.umidade %}
                        <td class="text-danger"> {{carga.umidade}}</td>
                        {% else %}
                        <td> {{carga.umidade}}</td>
                        {% endif %}

                        {% if carga.gessado == None %}
                        <td>-</td>
                        {% elif carga.gessado > pedido.gessado %}
                        <td class="text-danger"> {{carga.gessado}}</td>
                        {% else %}
                        <td> {{carga.gessado}}</td>
                        {% endif %}

                        {% if carga.bbranca == None %}
                        <td>-</td>
                        {% elif carga.bbranca > pedido.bbranca %}
                        <td class="text-danger"> {{carga.bbranca}}</td>
                        {% else %}
                        <td> {{carga.bbranca}}</td>
                        {% endif %}

                        {% if carga.amarelo == None %}
                        <td>-</td>
                        {% elif carga.amarelo > pedido.amarelo %}
                        <td class="text-danger"> {{carga.amarelo}}</td>
                        {% else %}
                        <td> {{carga.amarelo}}</td>
                        {% endif %}

                        {% if carga.manchpic == None %}
                        <td>-</td>
                        {% elif carga.manchpic > pedido.manchpic %}
                        <td class="text-danger"> {{carga.manchpic}}</td>
                        {% else %}
                        <td> {{carga.manchpic}}</td>
                        {% endif %}

                        {% if carga.vermelhos == None %}
                        <td>-</td>
                        {% elif carga.vermelhos > pedido.vermelhos %}
                        <td class="text-danger"> {{carga.vermelhos}}</td>
                        {% else %}
                        <td> {{carga.vermelhos}}</td>
                        {% endif %}

                        {% endif %}
                        {% endfor %}
                        {% endfor %}
                    </tr>
                <tfoot class="rodape">
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="2" class="border-top border-dark"></td>
                    <td align="right" colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark" style="text-align: center !important; vertical-align: middle"><strong><i>Totais</i></strong></td>
                    {% for p in pedidos %}
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|intcomma }}
                                Kg</i></b></td>
                    {% if total.peso__sum == None %}
                    <td align="center" class="border-top border-dark"><b>R$ &nbsp; - </b></td>
                    
                    {% else %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                        {{ totalnf.valornf__sum|floatformat:"2" }}
                            </i></b></td>
                    {% endif %}

                    <td align="center" class="border-top border-dark"><b><i><strong>Média</strong></i></td>
                    {% if mrenda.w_avg < p.renda %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mrenda.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark">
                        <b>{{ mrenda.w_avg|floatformat:2 }}</b></td>
                    {% endif %}

                    {% if minteiro.w_avg < p.inteiro %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ minteiro.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ minteiro.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mimpureza.w_avg > p.impureza %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mimpureza.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mimpureza.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}


                    {% if mumidade.w_avg > p.umidade %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mumidade.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mumidade.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mgessado.w_avg > p.gessado %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mgessado.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mgessado.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mbbranca.w_avg > p.bbranca %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mbbranca.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mbbranca.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mamarelo.w_avg > p.amarelo %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mamarelo.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mamarelo.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mmanchpic.w_avg > p.manchpic %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mmanchpic.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mmanchpic.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mvermelhos.w_avg > p.vermelhos %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mvermelhos.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark">
                        <b>{{ mvermelhos.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}
                    {% endfor %}
                </tfoot>
                </tbody>
            </table>
        </div>

        <div class="container-fluid" id="cargasrelatorio">
            <table class=" width table table-sm table-hover table-striped" align="center">
                <thead align="center" class=" thead-dark">

                    <tr>
                        <th scope="col"><a class="text-white fa fa-sort-desc"></a></th>
                        <th scope="col"><strong>Contrato</strong></th>
                        <th scope="col"><strong>Data</strong></th>
                        <th scope="col"><strong>Fornecedor</strong></th>
                        <th scope="col"><strong>Placa</strong></th>
                        <th scope="col"><strong>Motorista</strong></th>
                        <th scope="col"><strong>Peso</strong></th>
                        <th scope="col"><strong>Valor Produto</strong></th>
                        <th scope="col"><strong>NF</strong></th>
                        {% if notafiscal2 %}
                        <th scope="col"><strong>NF 2</strong></th>
                        {% else %}
                        {% endif %}

                        <th scope="col"><strong>Renda </strong></th>
                        <th scope="col"><strong>Inteiro </strong></th>
                        <th scope="col"><strong>Impureza </strong></th>
                        <th scope="col"><strong>Umidade </strong></th>
                        <th scope="col"><strong>Gessado </strong></th>
                        <th scope="col"><strong>B.Branca </strong></th>
                        <th scope="col"><strong>Amarelo</strong></th>
                        <th scope="col"><strong>Manch/Pic </strong></th>
                        <th scope="col"><strong>Vermelhos </strong></th>
                    </tr>


                </thead>

                <tbody class="align-text-bottom table-borderless">
                    {% for pedido in pedidos %}
                    <tr align="center" class="nothover">
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        <td align="right" colspan="3" class="border_bottom"></td>
                        <td colspan="1" class="border_bottom"></td>
                        {% if pedido.renda == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.renda }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.inteiro == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.inteiro }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.impureza == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.impureza }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.umidade == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.umidade }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.gessado == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.gessado }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.bbranca == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.bbranca }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.amarelo == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.amarelo }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.manchpic == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.manchpic }}</i></strong>
                        </td>
                        {% endif %}

                        {% if pedido.vermelhos == None %}
                        <td class="border_bottom">-</td>
                        {% else %}
                        <td class="border_bottom">
                            <strong><i>{{ pedido.vermelhos }}</i></strong>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                    {% for carga in cargas %}
                    {% for pedido in pedidos %}
                    {% if carga.situacao == 'Carregado' %}

                    <tr align="center" class="simplehighlight">
                        <td>{{ forloop.parentloop.counter }}</b></td>
                        <td><b>{{ carga.pedido }}</b></td>
                        <td><b>{{ carga.data|date:"SHORT_DATE_FORMAT" }}</b></td>
                        <td><b>{{ carga.pedido.fornecedor.nome|title }}
                            </b></td>
                        <td class="placa-format"><b>
                                {{ carga.placa|upper|slice:":3"}}  {{ carga.placa|upper|slice:"3:"}}</b></td>
                        <td><b>{{ carga.motorista|title }}</b></td>
                        <td><b>{{ carga.peso|intcomma }} Kg </b></td>
                        {% if carga.valornf == None or carga.valornf == 0 %}
                        <td><b>R$ &nbsp; - </b></td>
                        {% else %}
                        <td><b>R$ {{carga.valornf|floatformat:"2"}}</b></td>
                        {% endif %}
                        {% if carga.notafiscal == None %}
                        <td class="text-danger"><strong>Sem NF</strong></td>
                        {% elif carga.notafiscal|length <= 4 %}
                        <td><b>
                                {{ carga.notafiscal }}
                            </b></td>
                        {% elif carga.notafiscal|length <= 6 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 6 and carga.notafiscal|length < 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>

                        {% elif carga.notafiscal|length == 8 %}
                        <td><b>
                                0{{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% else %}
                        <td><b>{{carga.notasfiscal}}</b></td>
                        {% endif %}
                        {% if notafiscal2 %}
                        <td><b>{{carga.notasfiscal2}}</b></td>
                        {% else %}
                        {% endif %}

                        {% if carga.renda == None %}
                        <td><b>-</b></td>
                        {% elif carga.renda < pedido.renda %}
                        <td class="text-danger"><b> {{carga.renda}}</b></td>
                        {% else %}
                        <td><b> {{carga.renda}}</b></td>
                        {% endif %}

                        {% if carga.inteiro == None %}
                        <td><b>-</b></td>
                        {% elif carga.inteiro < pedido.inteiro %}
                        <td class="text-danger"><b> {{carga.inteiro}}</b></td>
                        {% else %}
                        <td><b> {{carga.inteiro}}</b></td>
                        {% endif %}

                        {% if carga.impureza == None %}
                        <td><b>-</b></td>
                        {% elif carga.impureza > pedido.impureza %}
                        <td class="text-danger"><b> {{carga.impureza}}</b></td>
                        {% else %}
                        <td><b> {{carga.impureza}}</b></td>
                        {% endif %}

                        {% if carga.umidade == None %}
                        <td><b>-</b></td>
                        {% elif carga.umidade > pedido.umidade %}
                        <td class="text-danger"><b> {{carga.umidade}}</b></td>
                        {% else %}
                        <td><b> {{carga.umidade}}</b></td>
                        {% endif %}

                        {% if carga.gessado == None %}
                        <td><b>-</b></td>
                        {% elif carga.gessado > pedido.gessado %}
                        <td class="text-danger"><b> {{carga.gessado}}</b></td>
                        {% else %}
                        <td><b> {{carga.gessado}}</b></td>
                        {% endif %}

                        {% if carga.bbranca == None %}
                        <td><b>-</b></td>
                        {% elif carga.bbranca > pedido.bbranca %}
                        <td class="text-danger"><b> {{carga.bbranca}}</b></td>
                        {% else %}
                        <td><b> {{carga.bbranca}}</b></td>
                        {% endif %}

                        {% if carga.amarelo == None %}
                        <td><b>-</b></td>
                        {% elif carga.amarelo > pedido.amarelo %}
                        <td class="text-danger"><b> {{carga.amarelo}}</b></td>
                        {% else %}
                        <td><b> {{carga.amarelo}}</b></td>
                        {% endif %}

                        {% if carga.manchpic == None %}
                        <td><b>-</b></td>
                        {% elif carga.manchpic > pedido.manchpic %}
                        <td class="text-danger"><b> {{carga.manchpic}}</b></td>
                        {% else %}
                        <td><b> {{carga.manchpic}}</b></td>
                        {% endif %}

                        {% if carga.vermelhos == None %}
                        <td><b>-</b></td>
                        {% elif carga.vermelhos > pedido.vermelhos %}
                        <td class="text-danger"><b> {{carga.vermelhos}}</b></td>
                        {% else %}
                        <td><b> {{carga.vermelhos}}</b></td>
                        {% endif %}

                        {% endif %}
                        {% endfor %}
                        {% endfor %}
                    </tr>
                <tfoot>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td align="right" colspan="1" class="border-top border-dark"></td>
                    <td align="center" colspan="1" class="border-top border-dark"><strong><i>Totais</i></strong></td>
                    {% for p in pedidos %}
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|intcomma }}
                                Kg</i></b></td>
                    {% if total.peso__sum == None %}
                    <td align="center" class="border-top border-dark"><b>R$ &nbsp; - </b></td>
                   
                    {% else %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                        {{ totalnf.valornf__sum|floatformat:"2" }}
                            </i></b></td>
                    {% endif %}

                    <td align="center" class="border-top border-dark"><b><i><strong>Média</strong></i></td>
                    {% if mrenda.w_avg < p.renda %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mrenda.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark">
                        <b>{{ mrenda.w_avg|floatformat:2 }}</b></td>
                    {% endif %}

                    {% if minteiro.w_avg < p.inteiro %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ minteiro.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ minteiro.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mimpureza.w_avg > p.impureza %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mimpureza.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mimpureza.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}


                    {% if mumidade.w_avg > p.umidade %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mumidade.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mumidade.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mgessado.w_avg > p.gessado %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mgessado.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mgessado.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mbbranca.w_avg > p.bbranca %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mbbranca.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mbbranca.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mamarelo.w_avg > p.amarelo %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mamarelo.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mamarelo.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mmanchpic.w_avg > p.manchpic %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mmanchpic.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark"><b>{{ mmanchpic.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}

                    {% if mvermelhos.w_avg > p.vermelhos %}
                    <td align="center" colspan="1" class="border-top border-dark text-danger"><b>
                            {{ mvermelhos.w_avg|floatformat:2 }}</b></td>
                    {% else %}
                    <td align="center" colspan="1" class="border-top border-dark">
                        <b>{{ mvermelhos.w_avg|floatformat:2 }}
                        </b></td>
                    {% endif %}
                    {% endfor %}
                </tfoot>
                </tbody>
            </table>
        </div>
        {% else %}
        <br>
        <br>
        <br>
        <div class="d-flex justify-content-center">
            <h1><span class="badge badge-danger badge-pill">Pedido ainda sem Cargas!!</span></h1>
        </div>


        {% endif %}

    </body>





</div>
{% elif pt.produto == "Arroz Beneficiado" %}
<!--Tabel do BENEFICIADO-->
<div class="table-responsive table-width my-table">

    <body>
        <br><br>
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Contrato </span></h2>
                </div>

            </div>
        </div>

        <!--------------------------PEdidos---------------------------->
        <table class="width table table-sm table-borderless align-text-center " width=100>
            <thead class="thead-dark ">
                <tr align="center">

                    <th scope="col"><strong> Contrato</strong></th>
                    <th scope=" col"><strong> Situação</strong></th>
                    <th scope="col"><strong> Data</strong></th>
                    <th scope="col"><strong> Fornecedor</strong></th>
                    <th scope="col"><strong> Origem </strong></th>
                    <th scope="col"><strong> Cliente</strong></th>
                    <th scope="col"><strong> Preço</strong></th>
                    <th scope="col"><strong> Produto</strong></th>
                    <th scope="col"><strong> Tipo</strong></th>
                    <th scope="col"><strong> Frete</strong></th>
                    <th scope="col"><strong> Quantidade</strong></th>
                    <th scope="col"><strong> Carregado</strong></th>
                    <th scope="col"><strong> Saldo</strong></th>
                </tr>

            </thead>
            <tbody class="">
                {% for pedido in pedidos %}

                <tr align="center">
                    <td class="border_bottom"> <strong>{{ pedido.contrato }}</strong></td>
                    {% if pedido.situacao == 'a' %}
                    <td class="border_bottom"><strong>Aberto</strong></td>
                    {% elif pedido.situacao == 'b' %}
                    <td class="border_bottom"><strong>Fechado</strong></td>
                    {% elif pedido.situacao == 'c' %}
                    <td class="border_bottom"><strong>Cancelado</strong></td>
                    {% else %}
                    {% endif %}
                    <td class="border_bottom"><strong>{{ pedido.data|date:"SHORT_DATE_FORMAT" }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor|title|truncatechars:35 }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor.cidade|truncatechars:25 }}</strong></td>

                    <td class="border_bottom"><strong>{{ pedido.cliente|upper }}</strong></td>


                    <td class="border_bottom"><strong>R$ {{ pedido.preco_produto|intcomma  }}</strong></td>
                    <td class="border_bottom"><strong> {{ pedido.produto  }} </strong></td>
                    {% if pedido.produto == 'Arroz em Casca' %}
                    <td class="border_bottom"><strong> Saco 50Kg </strong></td>
                    {% else %}
                    <td class="border_bottom"><strong> Fardo 30Kg </strong></td>
                    {% endif %}
                    <td class="border_bottom"><strong> R$ {{ pedido.preco_frete  }} </strong></td>
                    {% if pedido.produto == "Arroz em Casca" %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:50|floatformat:"0"}}
                            Scs </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:30|floatformat:"0"}}
                            Fds </strong></td>
                    {% endif %}


                    {% if pedido.carregado == 0 %}
                    <td class="border_bottom" align=center><strong> - </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong><strong>{{ pedido.carregado|div:30|floatformat:"0"}}
                                Fds</strong></strong>
                    </td>
                    {% endif %}
                    {% if pedido.saldo == 0 %}
                    <td class="border_bottom" align=center><strong> - </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong>{{ pedido.saldo|div:30|floatformat:"0" }}
                            Fds</strong></td>
                    {% endif %}
                </tr>

                {% endfor %}
            </tbody>
        </table>
        <br>


        <!--------------------------Cargas-------------------------------------------------------------->


        {% if cargas %}
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Relatório Carregamento
                        </span></h2>

                </div>

            </div>
        </div>

        <div class="container-fluid">
            <table class=" width table table-sm table-hover" align="center">



                <thead align="center" class=" thead-dark">

                    <tr>
                        <th scope="col"><a class="text-white fa fa-sort-desc"></a></th>
                        <th scope="col"><strong>Contrato</strong></th>
                        <th scope="col"><strong>Data</strong></th>
                        <th scope="col"><strong>Fornecedor</strong></th>
                        <th scope="col"><strong>Cidade</strong></th>
                        <th scope="col"><strong>Cliente</strong></th>
                        <th scope="col"><strong>Placa</strong></th>
                        <th scope="col"><strong>Motorista</strong></th>


                        <th scope="col"><strong>NF</strong></th>
                        {% if notafiscal2 %}
                        <th scope="col"><strong>NF 2</strong></th>
                        {% else %}
                        {% endif %}
                        <th scope="col"><strong>Peso</strong></th>
                        <th scope="col"><strong>Fardos</strong></th>
                        <th scope="col"><strong>Valor Produto</strong></th>
                    </tr>

                </thead>

                <tbody class="align-text-bottom table-borderless">

                    {% for carga in cargas %}
                    {% for pedido in pedidos %}
                    {% if carga.situacao == 'Carregado' %}

                    <tr align="center" class="simplehighlight">
                        <td>{{ forloop.parentloop.counter }}</b></td>
                        <td><b>{{ carga.pedido }}</b></td>
                        <td><b>{{ carga.data|date:"SHORT_DATE_FORMAT" }}</b></td>
                        <td><b>{{ carga.pedido.fornecedor.nome|title }}
                            </b></td>
                        
                        <td><b>{{ carga.pedido.fornecedor.cidade }}
                            </b></td>

                        <td><b>{{ carga.pedido.cliente.nome_fantasia|upper|truncatechars:38 }}
                            </b></td>
                        <td class="placa-format"><b>
                                {{ carga.placa|upper|slice:":3"}} {{ carga.placa|upper|slice:"3:"}}</b></td>
                        <td><b>{{ carga.motorista|title }}</b></td>


                        {% if carga.notafiscal == None %}
                        <td class="text-danger"><strong>Sem NF</strong></td>
                        {% elif carga.notafiscal|length <= 4 %}
                        <td><b>
                                {{ carga.notafiscal }}
                            </b></td>
                        {% elif carga.notafiscal|length <= 6 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 6 and carga.notafiscal|length < 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>

                        {% elif carga.notafiscal|length == 8 %}
                        <td><b>
                                0{{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% else %}
                        <td><b>{{carga.notasfiscal}}</b></td>
                        {% endif %}
                        {% if notafiscal2 %}
                        <td><b>{{carga.notasfiscal2}}</b></td>
                        {% else %}
                        {% endif %}
                        <td><b>{{ carga.peso|intcomma }} Kg </b></td>
                        <td><b>{{ carga.peso|div:30|floatformat:"0" }} Fds </b></td>
                        {% if carga.valornf == None or carga.valornf == 0 %}
                        <td><b>R$ &nbsp; - </b></td>
                        {% else %}
                        <td><b>R$ {{carga.valornf|floatformat:"2"}}</b></td>
                        {% endif %}



                        {% endif %}
                        {% endfor %}
                        {% endfor %}
                    </tr>
                <tfoot>
                    <td colspan="3" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td align="right" colspan="1" class="border-top border-dark"></td>
                    <td align="center" colspan="1" class="border-top border-dark"><strong><i></i></strong></td>
                    {% for p in pedidos %}
                    <td align="center" class="border-top border-dark"><b><i><strong>Totais</strong></i></td>
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|intcomma }}
                                Kg</i></b></td>
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|div:30|floatformat:"0" }}
                                Fds</i></b></td>


                    {% if total.peso__sum == None %}
                    <td align="center" class="border-top border-dark"><b>R$ &nbsp; - </b></td>
                    {% elif p.produto == 'Arroz em Casca' %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                                {{ total.peso__sum|div:50|mul:p.preco_produto|floatformat:"2" }}
                            </i></b></td>
                    {% else %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                                {{ totalnf.valornf__sum|floatformat:"2" }}
                            </i></b></td>
                    {% endif %}

                    {% endfor %}
                </tfoot>
                </tbody>
            </table>
        </div>
        {% else %}
        <br>
        <br>
        <br>
        <div class="d-flex justify-content-center">
            <h1><span class="badge badge-danger badge-pill">Pedido ainda sem Cargas!!</span></h1>
        </div>


        {% endif %}

    </body>

</div>
{% elif pt.produto == 'Semente' %}

<div class="table-responsive table-width my-table">

    <body>
        <br><br>
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Contrato </span></h2>
                </div>

            </div>
        </div>

        <!--------------------------PEdidos---------------------------->
        <table class="width table table-sm table-borderless align-text-center " width=100>
            <thead class="thead-dark table-bordered">
                <tr align="center">

                    <th scope="col"><strong> Contrato</strong></th>
                    <th scope=" col"><strong> Situação</strong></th>
                    <th scope="col"><strong> Data</strong></th>
                    <th scope="col"><strong> Fornecedor</strong></th>
                    <th scope="col"><strong> Origem </strong></th>
                    <th scope="col"><strong> Cliente</strong></th>
                    <th scope="col"><strong> Preço</strong></th>
                    <th scope="col"><strong> Produto</strong></th>
                    <th scope="col"><strong> Tipo</strong></th>
                    <th scope="col"><strong> Frete</strong></th>
                    <th scope="col"><strong> Quantidade</strong></th>
                    <th scope="col"><strong> Carregado</strong></th>
                    <th scope="col"><strong> Saldo</strong></th>
                </tr>

            </thead>
            <tbody class="table-bordered">
                {% for pedido in pedidos %}

                <tr align="center">
                    <td class="border_bottom"> <strong>{{ pedido.contrato }}</strong></td>
                    {% if pedido.situacao == 'a' %}
                    <td class="border_bottom"><strong>Aberto</strong></td>
                    {% elif pedido.situacao == 'b' %}
                    <td class="border_bottom"><strong>Fechado</strong></td>
                    {% elif pedido.situacao == 'c' %}
                    <td class="border_bottom"><strong>Cancelado</strong></td>
                    {% else %}
                    {% endif %}
                    <td class="border_bottom"><strong>{{ pedido.data|date:"SHORT_DATE_FORMAT" }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor|title|truncatechars:35 }}</strong></td>
                    <td class="border_bottom"><strong>{{ pedido.fornecedor.cidade|truncatechars:25 }}</strong></td>

                    <td class="border_bottom"><strong>{{ pedido.cliente|upper }}</strong></td>


                    <td class="border_bottom"><strong>R$ {{ pedido.preco_produto|intcomma  }}</strong></td>
                    <td class="border_bottom"><strong> {{ pedido.produto  }} </strong></td>
                    <td class="border_bottom"><strong> {{ pedido.tipo }} </strong></td>
                    
                    <td class="border_bottom"><strong> R$ {{ pedido.preco_frete  }} </strong></td>
                    {% if pedido.produto == "Arroz em Casca" %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:50|floatformat:"0"}}
                            Scs </strong></td>
                    {% elif pedido.produto == "Semente" %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:40|floatformat:"0"}}
                            Scs </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong>{{ pedido.quantidade_pedido|div:30|floatformat:"0"}}
                            Fds </strong></td>
                    {% endif %}


                    {% if pedido.carregado == 0 %}
                    <td class="border_bottom" align=center><strong> - </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong><strong>{{ pedido.carregado|div:40|floatformat:"0"}}
                                Fds</strong></strong>
                    </td>
                    {% endif %}
                    {% if pedido.saldo == 0 %}
                    <td class="border_bottom" align=center><strong> - </strong></td>
                    {% else %}
                    <td class="border_bottom" align=center><strong>{{ pedido.saldo|div:40|floatformat:"0" }}
                            Scs</strong></td>
                    {% endif %}
                </tr>

                {% endfor %}
            </tbody>
        </table>
        <br>


        <!--------------------------Cargas-------------------------------------------------------------->


        {% if cargas %}
        <div class="container">
            <div class="row">

                <div class="col" align="center">
                    <h2><span class="badge badge-success badge-pill">
                            Relatório Carregamento
                        </span></h2>

                </div>

            </div>
        </div>

        <div class="container-fluid">
            <table class=" width table table-sm table-hover" align="center">



                <thead align="center" class="table-bordered thead-dark">

                    <tr>
                        <th scope="col"><a class="text-white fa fa-sort-desc"></a></th>
                        <th scope="col"><strong>Contrato</strong></th>
                        <th scope="col"><strong>Data</strong></th>
                        <th scope="col"><strong>Fornecedor</strong></th>
                        <th scope="col"><strong>Cidade</strong></th>
                        <th scope="col"><strong>Cliente</strong></th>
                        <th scope="col"><strong>Placa</strong></th>
                        <th scope="col"><strong>Motorista</strong></th>


                        <th scope="col"><strong>NF</strong></th>
                        {% if notafiscal2 %}
                        <th scope="col"><strong>NF 2</strong></th>
                        {% else %}
                        {% endif %}
                        <th scope="col"><strong>Peso</strong></th>
                        <th scope="col"><strong>Sacos</strong></th>
                        <th scope="col"><strong>Valor Produto</strong></th>
                    </tr>

                </thead>

                <tbody class="align-text-bottom table-borderless">

                    {% for carga in cargas %}
                    {% for pedido in pedidos %}
                    {% if carga.situacao == 'Carregado' %}

                    <tr align="center" class="simplehighlight">
                        <td>{{ forloop.parentloop.counter }}</b></td>
                        <td><b>{{ carga.pedido }}</b></td>
                        <td><b>{{ carga.data|date:"SHORT_DATE_FORMAT" }}</b></td>
                        <td><b>{{ carga.pedido.fornecedor.nome|title }}
                            </b></td>
                        
                        <td><b>{{ carga.pedido.fornecedor.cidade }}
                            </b></td>

                        <td><b>{{ carga.pedido.cliente.nome_fantasia|upper|truncatechars:38 }}
                            </b></td>
                        <td class="placa-format"><b>
                                {{ carga.placa|upper|slice:":3"}} {{ carga.placa|upper|slice:"3:"}}</b></td>
                        <td><b>{{ carga.motorista|title }}</b></td>


                        {% if carga.notafiscal == None %}
                        <td class="text-danger"><strong>Sem NF</strong></td>
                        {% elif carga.notafiscal|length <= 4 %}
                        <td><b>
                                {{ carga.notafiscal }}
                            </b></td>
                        {% elif carga.notafiscal|length <= 6 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 6 and carga.notafiscal|length < 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>

                        {% elif carga.notafiscal|length == 8 %}
                        <td><b>
                                0{{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% elif carga.notafiscal|length > 8 %}
                        <td><b>
                                {{ carga.notafiscal|slice:"-9:-6" }}.{{ carga.notafiscal|slice:"-6:-3" }}.{{ carga.notafiscal|slice:"-3:" }}
                            </b></td>
                        {% else %}
                        <td><b>{{carga.notasfiscal}}</b></td>
                        {% endif %}
                        {% if notafiscal2 %}
                        <td><b>{{carga.notasfiscal2}}</b></td>
                        {% else %}
                        {% endif %}
                        <td><b>{{ carga.peso|intcomma }} Kg </b></td>
                        <td><b>{{ carga.peso|div:40|floatformat:"0" }} Scs </b></td>
                        {% if carga.valornf == None or carga.valornf == 0 %}
                        <td><b>R$ &nbsp; - </b></td>
                        {% else %}
                        <td><b>R$ {{carga.valornf|floatformat:"2"}}</b></td>
                        {% endif %}



                        {% endif %}
                        {% endfor %}
                        {% endfor %}
                    </tr>
                <tfoot>
                    <td colspan="3" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td colspan="1" class="border-top border-dark"></td>
                    <td align="right" colspan="1" class="border-top border-dark"></td>
                    <td align="center" colspan="1" class="border-top border-dark"><strong><i></i></strong></td>
                    {% for p in pedidos %}
                    <td align="center" class="border-top border-dark"><b><i><strong>Totais</strong></i></td>
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|intcomma }}
                                Kg</i></b></td>
                    <td align="center" class="border-top border-dark"><b><i>{{ total.peso__sum|div:40|floatformat:"0" }}
                                Scs</i></b></td>


                    {% if total.peso__sum == None %}
                    <td align="center" class="border-top border-dark"><b>R$ &nbsp; - </b></td>
                    {% elif p.produto == 'Arroz em Casca' %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                                {{ total.peso__sum|div:40|mul:p.preco_produto|floatformat:"2" }}
                            </i></b></td>
                    {% else %}
                    <td align="center" class="border-top border-dark"><b><i>R$
                                {{ totalnf.valornf__sum|floatformat:"2" }}
                            </i></b></td>
                    {% endif %}

                    {% endfor %}
                </tfoot>
                </tbody>
            </table>
        </div>
        {% else %}
        <br>
        <br>
        <br>
        <div class="d-flex justify-content-center">
            <h1><span class="badge badge-danger badge-pill">Pedido ainda sem Cargas!!</span></h1>
        </div>


        {% endif %}

    </body>

</div>

{% else %}
<h1> Outro Tipo </h1>
{% endif %}
{% endfor %}















</body>
<!-- jQuery -->
<script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="{% static 'js/popper.min.js' %}"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="{% static 'js/mdb.min.js' %}"></script>
<!-- Your custom scripts (optional) -->
<script type="text/javascript"></script>
<!-- MDBootstrap Datatables  -->
<script type="text/javascript" src="{% static 'js/addons/datatables.min.js' %}"></script>
<script>
    
    $(".simplehighlight").click(function() {
        $(this).toggleClass('clicked');
    });
    
    
    $(document).ready(function () {
        $('#cargas').DataTable({
            "order": [[3, "asc"]]
        });
        $('.dataTables_length').addClass('bs-select');
    });

    window.setTimeout(function () {
        $(".alert").fadeTo(500, 0).slideUp(500, function () {
            $(this).remove();
        });
    }, 3000);
</script>

<script>
    $(document).ready(function () {
        $("#btnExport").click(function (e) {
            e.preventDefault();
            var table_div = document.getElementById('cargasrelatorio2');
            // esse "\ufeff" é importante para manter os acentos         
            var blobData = new Blob(['\ufeff' + table_div.outerHTML], { type: 'application/vnd.ms-excel' });
            var url = window.URL.createObjectURL(blobData);
            var a = document.createElement('a');
            a.href = url;
            {% for carga in cargas %}
            a.download = '{{ carga.pedido }}_{{ carga.pedido.fornecedor.nome|title}}.xls'
            {% endfor %}
            a.click();
        });
    });


    function createPDF() {
        var sTable = document.getElementById('cargasrelatorio2').innerHTML;

        var style = "<style>";
        style = style + "table {width: 100%;font: 12px Calibri; margin-top: 60px; border-collapse: collapse;}";
        style = style + "thead>tr>th{border-bottom: double;}";
        style = style + ".corpo , .corpodados>td {border: dotted 1px #DDD; border-collapse: separate !important;}";
        style = style + "table, td, tr, th {white-space: nowrap;";
        style = style + "padding: 2px 3px;text-align: center;}";
        style = style + "tbody tr{border-left: solid 1px black;border-right: solid 1px black;}";
        style = style + "tbody tr:nth-child(2) td{border-top: solid 1px black;}";
        style = style + ".rodape {border-top: solid 2px black;}";        
        style = style + "</style>";

        // CREATE A WINDOW OBJECT.
        var win = window.open('', '', "_blank", 'height=700,width=700');

        win.document.write('<html><head>');
        win.document.write('<title>{% for pedido in pedidos %}{{ pedido.contrato }} | {{ pedido.fornecedor.nome|title}}{% endfor%} </title>');   // <title> FOR PDF HEADER.
        win.document.write(style);          // ADD STYLE INSIDE THE HEAD TAG.
        win.document.write('</head>');
        win.document.write('<body>');
        win.document.write(sTable);         // THE TABLE CONTENTS INSIDE THE BODY TAG.
        win.document.write('<embed width="100%" height="100%" src="data:application/pdf;base64,' + base64 + '" type="application/pdf"/>');
        win.document.write('</body></html>');

        win.document.close(); 	// CLOSE THE CURRENT WINDOW.

    }
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
