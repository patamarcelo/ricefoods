{% load bootstrap4 %}
{% load humanize %}
{% block content %}
{% load mathfilters %}

<div class="container">
    <div class="row">
        <div class="col" align=center>
            <h2><strong><a class="badge badge-primary badge-pill"> Acompanhamento Pre√ßo Casca</a></strong></h2>
        </div>
    </div>
</div>
<br>
<div class="row">
    <div class="col-6 sm">
        <div class="container-fluid sombra">
            <canvas id="cda" style="max-height: 400px; width: auto; position: relative;"></canvas>
        </div>
    </div>
    <div class="col-6 sm">
        <div class="container-fluid sombra">
            <canvas id="ruston" style="max-height: 400px; width: auto; position: relative;"></canvas>
        </div>
    </div>
</div>
<br />
<!-- <div>
    <div class="col sm">
        <div class="container-fluid sombra">
            <canvas id="teste" style="max-height: 400px; width: auto; position: relative;"></canvas>
        </div>
    </div>
</div>
<br /> -->


<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script type="text/javascript">

    function getRandomColor() {
        var letters = "0123456789ABCDEF".split("");
        var color = "#";
        for (var i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    }

    Chart.defaults.global.defaultFontColor = 'black';
    var ctx = document.getElementById('cda').getContext('2d');

    var labelcd = [{% for p in chart %} {% if 'CDA' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto  and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.data|safe }}", {% endif %} {% endfor %}];
    var labelcda = labelcd.slice(-15);

    var labelru = [{% for p in chart %} {% if 'RUS' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.data|safe }}", {% endif %} {% endfor %}];
    var labelrus = labelru.slice(-15);

    var labelcap = [{% for p in chart %} {% if 'CAP' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.data|safe }}", {% endif %} {% endfor %}];


    var data1cd = [{% for p in chart %} {% if 'CDA' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.preco_produto|safe }}", {% endif %}{% endfor %}];
    var data1cda = data1cd.slice(-15);

    var data1ru = [{% for p in chart %} {% if 'UST' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.preco_produto|safe }}", {% endif %}{% endfor %}];
    var data1rus = data1ru.slice(-15);

    var data1cap = [{% for p in chart %} {% if 'CAP' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.preco_produto|safe }}", {% endif %}{% endfor %}];


    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'line',

        // The data for our dataset
        data: {
            labels: labelcda,
            datasets: [{
                label: 'CDA - Casca',
                // fillcolor: getRandomColor(),
                // backgroundColor: getRandomColor(),
                borderColor: 'rgba(235, 51, 19, 1)',
                backgroundColor: 'rgba(235, 51, 19, 1)',
                fontColor: 'rgba(235, 235, 205, 1)',
                borderWidth: 2,
                lineTension: 0.1,
                fill: false,
                data: data1cda,
            }],
        },
        // Configuration options go here
        options: {
            legend: {
            labels: {
                // This more specific font property overrides the global property
                fontColor: 'rgba(235, 235, 205, 1)'
            }
        }
        }
        
    });



    Chart.defaults.global.defaultFontColor = 'black';
    var ctx = document.getElementById('ruston').getContext('2d');
    var labelrus = [{% for p in chart %} {% if 'RUS' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.data|safe }}", {% endif %} {% endfor and 'Arroz em Casca' in p.produto %}];
    var data1rus = [{% for p in chart %} {% if 'RUS' in p.cliente.nome_fantasia|upper and 'Arroz em Casca' in p.produto and 'Palmaresa' not in p.fornecedor.nome %} "{{ p.preco_produto|safe }}", {% endif %}{% endfor %}];



    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'line',

        // The data for our dataset
        data: {
            labels: labelrus,
            datasets: [{
                label: 'Ruston - Casca',
                // fillcolor: getRandomColor(),
                // backgroundColor: getRandomColor(),
                borderColor: 'blue',
                backgroundColor: 'blue',
                fill: false,
                data: data1rus
            }],
        },
        // Configuration options go here
        options: {
            legend: {
            labels: {
                // This more specific font property overrides the global property
                fontColor: 'rgba(235, 235, 205, 1)'
            }
        }
        }
    });

    var ctx = document.getElementById('teste').getContext('2d');
    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'bar',


        // The data for our dataset
        data: {
            labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
            datasets: [{
                label: 'My First dataset',
                // fillcolor: getRandomColor(),
                backgroundColor: getRandomColor(),
                borderColor: getRandomColor(),
                data: [0, 10, 5, 2, 20, 30, 45]
            },
            {
                label: 'My Second one',
                backgroundColor: getRandomColor(),
                borderColor: getRandomColor(),
                data: [0, 20, 25, 32, 70, 30, 45]
            },
            {
                label: 'Terceiro',
                backgroundColor: getRandomColor(),
                borderColor: getRandomColor(),
                data: [0, 20, 25, 32, 70, 30, 45]
            }]
        },

        // Configuration options go here
        options: {
            legend: {
            labels: {
                // This more specific font property overrides the global property
                fontColor: 'rgba(235, 235, 205, 1)'
            }
        }
        }
    });

</script>
{% endblock %}